{
    "beforeSaveCustomScript": "/////////////////////////////////////\n// Primary Household Member Script //\n/////////////////////////////////////\n\n$newandprimary = ifThen(entity\\isNew() == true && primaryPA == true, true, false);\n\nifThen($newandprimary == true,\n\t$primaryhouseholdmember = id;\n\t$HHid = record\\create('Account');\n\thouseholdId = $HHid;\n\thouseholdPrimaryId = $HHid;\n\t);\n\nifThen(entity\\isAttributeChanged('primaryPA') == true && primaryPA == true,\n    $oldprimarymemberid = household.primaryHhMemberId;\n    record\\update('HHMember', $oldprimarymemberid, 'primaryPA', false);\n    householdPrimaryId = householdId;\n    record\\update('Account', householdId, 'primaryHhMemberId', id);\n    record\\update('Account', householdPrimaryId, 'name', name);\n    record\\update('Account', householdPrimaryId, 'dateofbirth', dateofbirth);\n    record\\update('Account', householdPrimaryId, 'idNumber', idNumber);\n    record\\update('Account', householdPrimaryId, 'gender', gender);\n    record\\update('Account', householdPrimaryId, 'phoneNumber', phoneNumber);\n    record\\update('Account', householdPrimaryId, 'phonewa', phonewa);\n    record\\update('Account', householdPrimaryId, 'primLanguage', primLanguage);\n    record\\update('Account', householdPrimaryId, 'billingAddressStreet', addressStreet);\n    record\\update('Account', householdPrimaryId, 'billingAddressCity', addressCity);\n    record\\update('Account', householdPrimaryId, 'billingAddressPostalCode', addressPostalCode);\n    record\\update('Account', householdPrimaryId, 'houseNumber', houseNumber);\n    );\n\n\nifThen(primaryPA == true,\n    ifThen(entity\\isAttributeChanged('name') == true, record\\update('Account', householdPrimaryId, 'name', name));\n    ifThen(entity\\isAttributeChanged('dateofbirth') == true, record\\update('Account', householdPrimaryId, 'dateofbirth', dateofbirth));\n\tifThen(entity\\isAttributeChanged('idNumber') == true, record\\update('Account', householdPrimaryId, 'idNumber', idNumber));\n\tifThen(entity\\isAttributeChanged('gender') == true, record\\update('Account', householdPrimaryId, 'gender', gender));\n\tifThen(entity\\isAttributeChanged('phoneNumber') == true, record\\update('Account', householdPrimaryId, 'phoneNumber', phoneNumber));\n\tifThen(entity\\isAttributeChanged('phonewa') == true, record\\update('Account', householdPrimaryId, 'phonewa', phonewa));\n\tifThen(entity\\isAttributeChanged('primLanguage') == true, record\\update('Account', householdPrimaryId, 'primLanguage', primLanguage));\n    ifThen(entity\\isAttributeChanged('addressStreet') == true, record\\update('Account', householdPrimaryId, 'billingAddressStreet', addressStreet));\n\tifThen(entity\\isAttributeChanged('addressCity') == true, record\\update('Account', householdPrimaryId, 'billingAddressCity', addressCity));\n\tifThen(entity\\isAttributeChanged('addressPostalCode') == true, record\\update('Account', householdPrimaryId, 'billingAddressPostalCode', addressPostalCode));\n\tifThen(entity\\isAttributeChanged('houseNumber') == true, record\\update('Account', householdPrimaryId, 'houseNumber', houseNumber));\n    );\n\nifThen(primaryPA == false,\n    addressStreet = household.billingAddressStreet;\n    addressCity = household.billingAddressCity;\n    addressPostalCode = household.billingAddressPostalCode;\n    houseNumber = household.houseNumber;\n    );\n\n///////////////////////////////////////////////\n// Age calculation for Household composition //\n///////////////////////////////////////////////\n\n// Age calculation\n$agecalc = datetime\\diff(datetime\\today(), dateofbirth,'years');\n\n// Agegroup calculation (referred to in Household entity)\nagegroupCalculated02 = ifThenElse(status == 'Active' && $agecalc<3, 1, 0);\nagegroupCalculated317 = ifThenElse(status == 'Active' && $agecalc>=3 && $agecalc <18, 1, 0);\nagegroupCalculated1865 = ifThenElse(status == 'Active' && $agecalc>=18 && $agecalc <65, 1, 0);\nagegroupCalculated65plus = ifThenElse(status == 'Active' && $agecalc>=65, 1, 0);"
}