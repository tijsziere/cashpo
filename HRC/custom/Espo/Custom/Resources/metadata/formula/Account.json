{
    "beforeSaveCustomScript": "///////////////////////////////////////\n// Household composition calculation //\n///////////////////////////////////////\n\nhh02 = entity\\sumRelated('hhMembers','agegroupCalculated02');\nhh317 = entity\\sumRelated('hhMembers','agegroupCalculated317');\nhh1865 = entity\\sumRelated('hhMembers','agegroupCalculated1865');\nhh65 = entity\\sumRelated('hhMembers','agegroupCalculated65plus');\nhhTotal = hh02 + hh317 + hh1865 + hh65;\n\n\n////////////////////////////////\n// Household update addresses //\n////////////////////////////////\n\n// Change Address for household members\nifThen(entity\\isAttributeChanged('billingAddressStreet') == true || entity\\isAttributeChanged('billingAddressCity') == true || entity\\isAttributeChanged('billingAddressPostalCode') == true || entity\\isAttributeChanged('houseNumber') == true,\n    $listIds = record\\findRelatedMany('Account', id, 'hhMembers', 25);\n    $i = 0;\n    while($i < array\\length($listIds),\n        $vID = array\\at($listIds, $i);\n        $addressfield = record\\attribute('HHMember', $vID, 'addressStreet');\n        $cityfield = record\\attribute('HHMember', $vID, 'addressCity');\n        $postalcodefield = record\\attribute('HHMember', $vID, 'addressPostalCode');\n        $househumberfield = record\\attribute('HHMember', $vID, 'houseNumber');\n        \n        ifThen($addressfield != billingAddressStreet,\n            record\\update('HHMember', $vID, 'addressStreet',billingAddressStreet);\n            );\n        \n        ifThen($cityfield != billingAddressCity,    \n            record\\update('HHMember', $vID, 'addressCity', billingAddressCity);\n            );\n        \n        ifThen($postalcodefield != billingAddressPostalCode,\n            record\\update('HHMember', $vID, 'addressPostalCode', billingAddressPostalCode);\n            );\n        \n        ifThen($househumberfield != houseNumber,\n            record\\update('HHMember', $vID, 'houseNumber', houseNumber);\n            );\n       \n        $i = $i + 1;\n    );\n);"
}